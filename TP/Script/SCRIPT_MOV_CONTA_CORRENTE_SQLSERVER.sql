CREATE DATABASE MOV_CONTA_CORRENTE
GO

USE MOV_CONTA_CORRENTE
GO

CREATE TABLE AGENCIAS(
	NUM_AGE	NUMERIC(5,0) PRIMARY KEY NOT NULL,
	NOME_AGE VARCHAR(30) NOT NULL,
	ENDE_AGE VARCHAR(50) NOT NULL,
	NUME_AGE VARCHAR(8),
	COMPL_AGE VARCHAR(20),
	BAIR_AGE VARCHAR(20),
	CIDA_AGE VARCHAR(30) NOT NULL,
	UF_AGE CHAR(2) NOT NULL,
	CEP_AGE CHAR(8) NOT NULL,
	FONE_AGE VARCHAR(13)
	)

CREATE TABLE CLIENTES(
	ID_CLI NUMERIC(9,0) PRIMARY KEY NOT NULL,
	NOME_CLI VARCHAR(50) NOT NULL,
	ENDE_CLI VARCHAR(50) NOT NULL,
	NUME_CLI VARCHAR(8),
	COMPL_CLI VARCHAR(20),
	BAIR_CLI VARCHAR(20),
	CIDA_CLI VARCHAR(30) NOT NULL,
	UF_CLI CHAR(2) NOT NULL,
	CEP_CLI CHAR(8) NOT NULL,
	FONE_CLI VARCHAR(13),
	CPF_CLI CHAR(11),
	DATA_NASC DATETIME,
	CNPJ_CLI CHAR(14)
)

CREATE TABLE HISTORICOS(
	ID_HIS NUMERIC(4,0) PRIMARY KEY NOT NULL,
	DES_HIS VARCHAR(30) NOT NULL
)

CREATE TABLE CONTACORRENTE(
	NUM_AGE NUMERIC(5,0) NOT NULL,
	NUM_CC NUMERIC(10,0) NOT NULL,
	ID_CLI NUMERIC(9,0) NOT NULL,
	SALDO NUMERIC(15,2),
	PRIMARY KEY (NUM_AGE,NUM_CC),
	CONSTRAINT FK_CONTACORRENTE_AGE FOREIGN KEY (NUM_AGE) REFERENCES AGENCIAS(NUM_AGE),
	CONSTRAINT FK_CONTACORRENTE_CLI FOREIGN KEY (ID_CLI) REFERENCES CLIENTES(ID_CLI)
)

CREATE TABLE USUARIOS(
	ID VARCHAR(20) PRIMARY KEY NOT NULL,
	SENHA VARCHAR(20) NOT NULL,
	NUM_AGE NUMERIC(5,0) NOT NULL,
	NUM_CC NUMERIC(10,0) NOT NULL,
	CONSTRAINT FK_USUARIOS_CC FOREIGN KEY (NUM_AGE,NUM_CC) REFERENCES CONTACORRENTE(NUM_AGE,NUM_CC)
)

CREATE TABLE MOVIMENTACAO(
	NUM_AGE NUMERIC(5,0) NOT NULL,
	NUM_CC NUMERIC(10,0) NOT NULL,
	DATA_MOV DATETIME NOT NULL,
	NUM_DOCTO VARCHAR(6) NOT NULL,
	DEBITO_CREDITO CHAR(1) NOT NULL,
	ID_HIS NUMERIC(4,0) NOT NULL,
	COMPL_HIS VARCHAR(30),
	VALOR NUMERIC(9,2) NOT NULL,
	SALDO NUMERIC(15,2),
	PRIMARY KEY (NUM_AGE,NUM_CC,DATA_MOV,NUM_DOCTO),
	CONSTRAINT FK_MOVIMENTACAO_AGE FOREIGN KEY (NUM_AGE) REFERENCES AGENCIAS(NUM_AGE),
	CONSTRAINT FK_MOVIMENTACAO_CC FOREIGN KEY (NUM_AGE,NUM_CC) REFERENCES CONTACORRENTE(NUM_AGE,NUM_CC),
	CONSTRAINT FK_MOVIMENTACAO_HIS FOREIGN KEY (ID_HIS) REFERENCES HISTORICOS(ID_HIS)
)
	
INSERT INTO AGENCIAS (NUM_AGE, NOME_AGE, ENDE_AGE, NUME_AGE, COMPL_AGE, BAIR_AGE, CIDA_AGE, UF_AGE, CEP_AGE, FONE_AGE)
VALUES
(10001, 'Agencia Coruscant', 'Avenida República', '100', 'Apto 12', 'Bairro Centro', 'São Paulo', 'SP', '01010000', '11987654321'),
(10002, 'Agencia Tatooine', 'Rua do Sol', '200', 'Apto 34', 'Bairro Deserto', 'Rio de Janeiro', 'RJ', '22020000', '21987654321'),
(10003, 'Agencia Naboo', 'Praça Real', '300', 'Sala 1', 'Bairro Palácio', 'Brasília', 'DF', '73030000', '61987654321'),
(10004, 'Agencia Hoth', 'Estrada Fria', '400', NULL, 'Bairro Gelado', 'Porto Alegre', 'RS', '91040000', '51987654321'),
(10005, 'Agencia Endor', 'Rua Florestal', '500', 'Casa 2', 'Bairro Verde', 'Curitiba', 'PR', '81050000', '41987654321');

INSERT INTO CLIENTES (ID_CLI, NOME_CLI, ENDE_CLI, NUME_CLI, COMPL_CLI, BAIR_CLI, CIDA_CLI, UF_CLI, CEP_CLI, FONE_CLI, CPF_CLI, DATA_NASC, CNPJ_CLI)
VALUES
(1, 'Luke Skywalker', 'Avenida República', '100', 'Apto 12', 'Bairro Centro', 'São Paulo', 'SP', '01010000', '11987654321', '12345678901', '02-05-1977', NULL),
(2, 'Leia Organa', 'Rua Alderaan', '200', 'Apto 20', 'Bairro Nobre', 'Rio de Janeiro', 'RJ', '22020000', '21987654321', '10987654321', '25-05-1977', NULL),
(3, 'Han Solo', 'Estrada Kessel', '300', 'Hangar 5', 'Bairro Porto', 'Curitiba', 'PR', '81050000', '41987654321', '98765432109', '15-05-1977', NULL),
(4, 'Chewbacca', 'Rua Kashyyyk', '400', 'Casa 1', 'Bairro Floresta', 'Porto Alegre', 'RS', '91040000', '51987654321', '87654321098', '07-05-1977', NULL),
(5, 'Darth Vader', 'Avenida Sith', '500', NULL, 'Bairro Imperial', 'Brasília', 'DF', '73030000', '61987654321', '76543210987', '09-05-1977', NULL);

INSERT INTO HISTORICOS (ID_HIS, DES_HIS)
VALUES
(1001, 'Depósito Galáctico'),
(1002, 'Transferência Imperial'),
(1003, 'Saque em Agência'),
(1004, 'Pagamento Bounty Hunter'),
(1005, 'Reembolso Jedi');

INSERT INTO CONTACORRENTE (NUM_AGE, NUM_CC, ID_CLI, SALDO)
VALUES
(10001, 1234567890, 1, 10000.00),
(10002, 2345678901, 2, 15000.50),
(10003, 3456789012, 3, 20000.75),
(10004, 4567890123, 4, 25000.25),
(10005, 5678901234, 5, 50000.00);

INSERT INTO USUARIOS (ID, SENHA, NUM_AGE, NUM_CC)
VALUES
('luke_skywalker', 'forca123', 10001, 1234567890),
('leia_organa', 'rebelião456', 10002, 2345678901),
('han_solo', 'falcao789', 10003, 3456789012),
('chewbacca', 'wookiee321', 10004, 4567890123),
('darth_vader', 'ladonegro', 10005, 5678901234);

INSERT INTO MOVIMENTACAO (NUM_AGE, NUM_CC, DATA_MOV, NUM_DOCTO, DEBITO_CREDITO, ID_HIS, COMPL_HIS, VALOR, SALDO)
VALUES
(10001, 1234567890, '19-09-2014', '000001', 'C', 1001, 'Depósito inicial', 5000.00, 15000.00),
(10002, 2345678901, '19-09-2014', '000002', 'D', 1002, 'Transferência para Han', 2000.00, 13000.50),
(10003, 3456789012, '19-09-2014', '000003', 'C', 1003, 'Saque em Curitiba', 3000.00, 23000.75),
(10004, 4567890123, '19-09-2014', '000004', 'D', 1004, 'Pagamento de recompensas', 5000.00, 20000.25),
(10005, 5678901234, '19-09-2014', '000005', 'C', 1005, 'Reembolso Jedi', 10000.00, 60000.00);

SELECT * FROM MOVIMENTACAO;